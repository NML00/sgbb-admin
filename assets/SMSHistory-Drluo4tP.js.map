{"version":3,"file":"SMSHistory-Drluo4tP.js","sources":["../../src/views/dashboard/user/SMSHistory.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {\n  Table,\n  TableBody,\n  TableCaption,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow\n} from '@/components/ui/table'\n\nimport {\n  Pagination,\n  PaginationEllipsis,\n  PaginationList,\n  PaginationListItem,\n  PaginationNext,\n  PaginationPrev\n} from '@/components/ui/pagination'\n\nimport { computed, ref } from 'vue'\nimport { formateDate, myDateFormatter, truncateNumber } from '@/lib/utils'\nimport { useMyFetch, type ListData, type Response } from '@/config/fetch'\nimport { Input } from '@/components/ui/input'\n\nexport type SMS = {\n  phone: string\n  type: string\n  timestamps: number\n  status: boolean\n  createdAt: string\n  id: string\n  otp: string\n}\n\nconst smsParams = ref({\n  page: 1,\n  limit: 10,\n  userId: '',\n  phone: '',\n  type: ''\n})\nconst apiRoute = 'user/history/sms'\nconst fullApiRoute = computed(() => {\n  const query = new URLSearchParams(smsParams.value as any)\n  const delKeys: Array<string> = []\n  query.forEach((value, key) => {\n    if (value === undefined || value === 'undefined' || value === '') {\n      delKeys.push(key)\n    }\n  })\n  delKeys.forEach((el) => {\n    query.delete(el)\n  })\n\n  return `${apiRoute}?${query.toString()}`\n})\n\nconst { data, isFetching: pending } = useMyFetch(fullApiRoute, { refetch: true }).json<\n  Response<ListData<SMS>>\n>()\nconst smsHistory = computed(() => {\n  return data.value?.metaData\n})\nconst showFilter = ref(true)\n</script>\n\n<template>\n  <Card class=\"\">\n    <CardHeader>\n      <CardTitle> Lịch sử SMS </CardTitle>\n    </CardHeader>\n    <CardContent>\n      <div class=\"mt-4 bg-card text-card-foreground p-2 rounded\">\n        <div class=\"text-xl flex gap-2 items-center\">\n          Bộ lọc\n          <button\n            @click=\"showFilter = !showFilter\"\n            class=\"hover:bg-accent/50 active:bg-accent rounded p-1\"\n          >\n            <Icon\n              name=\"Triangle\"\n              :class=\"{ 'rotate-180': !showFilter }\"\n              class=\"w-[0.75em] h-[0.75em]\"\n            />\n          </button>\n        </div>\n        <div :class=\"{ hidden: !showFilter }\" class=\"flex flex-wrap items-center transition -mx-1\">\n          <div class=\"basis-full sm:basis-1/2 md:basis-1/3 px-1\">\n            <label>\n              Số điện thoại\n              <Input v-model=\"smsParams.phone\" placeholder=\"Số điện thoại (e.g. 09012222222)\" />\n            </label>\n          </div>\n          <div class=\"basis-full sm:basis-1/2 md:basis-1/3 px-1\">\n            <label>\n              Loại\n              <Input v-model=\"smsParams.type\" class=\"uppercase\" placeholder=\"Loại OTP\" />\n            </label>\n          </div>\n        </div>\n      </div>\n      <div class=\"mt-4\">\n        <div class=\"border rounded\">\n          <Table class=\"\" :loading=\"pending\">\n            <TableCaption>\n              <div>Đây là các lệnh SMS trong hệ thống</div>\n            </TableCaption>\n            <TableHeader>\n              <TableRow>\n                <TableHead> Số Điện thoại\n                  <span class=\"sm:hidden\"> / Loại</span>  \n                </TableHead>\n                <TableHead> Mã OTP </TableHead>\n                <TableHead class=\"hidden sm:table-cell\"> Loại </TableHead>\n                <TableHead> Ngày tạo </TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody v-if=\"smsHistory\">\n              <TableRow v-for=\"entry in smsHistory?.results\" :key=\"entry.id\" class=\"odd:bg-muted\">\n                <TableCell>\n                  {{ entry.phone }}\n                  <div class=\"sm:hidden\">\n                    {{ entry.type }}\n                  </div>\n                </TableCell>\n                <TableCell>\n                  {{ entry.otp }}\n                </TableCell>\n                <TableCell class=\"hidden sm:table-cell\">\n                  {{ entry.type }}\n                </TableCell>\n                <TableCell>\n                  {{ myDateFormatter.format(new Date(entry.createdAt)) }}\n                </TableCell>\n              </TableRow>\n            </TableBody>\n          </Table>\n        </div>\n        <Pagination\n          v-if=\"smsHistory\"\n          class=\"mt-4\"\n          v-slot=\"{ page }\"\n          :items-per-page=\"smsHistory.limit\"\n          :total=\"smsHistory.totalResults\"\n          show-edges\n          v-model:page=\"smsParams.page\"\n          :disabled=\"pending\"\n        >\n          <PaginationList v-slot=\"{ items }\" class=\"flex items-center gap-1\">\n            <PaginationPrev class=\"w-6 h-6\"></PaginationPrev>\n            <template v-for=\"(item, index) in items\">\n              <PaginationListItem\n                v-if=\"item.type === 'page'\"\n                :key=\"index\"\n                :value=\"item.value\"\n                as-child\n              >\n                <button\n                  class=\"w-6 h-6 p-0 hover:bg-primary/50 cursor-pointer rounded\"\n                  :class=\"{\n                    'bg-primary text-primary-foreground': item.value === page\n                  }\"\n                >\n                  {{ item.value }}\n                </button>\n              </PaginationListItem>\n              <PaginationEllipsis v-else :key=\"item.type\" :index=\"index\" />\n            </template>\n            <PaginationNext class=\"w-6 h-6\"></PaginationNext>\n          </PaginationList>\n        </Pagination>\n      </div>\n    </CardContent>\n  </Card>\n</template>\n"],"names":["apiRoute","smsParams","ref","fullApiRoute","computed","query","delKeys","value","key","el","data","pending","useMyFetch","smsHistory","_a","showFilter"],"mappings":"qrBA0CMA,GAAW,uDAPjB,MAAMC,EAAYC,EAAI,CACpB,KAAM,EACN,MAAO,GACP,OAAQ,GACR,MAAO,GACP,KAAM,EAAA,CACP,EAEKC,EAAeC,EAAS,IAAM,CAClC,MAAMC,EAAQ,IAAI,gBAAgBJ,EAAU,KAAY,EAClDK,EAAyB,CAAC,EAC1B,OAAAD,EAAA,QAAQ,CAACE,EAAOC,IAAQ,EACxBD,IAAU,QAAaA,IAAU,aAAeA,IAAU,KAC5DD,EAAQ,KAAKE,CAAG,CAClB,CACD,EACOF,EAAA,QAASG,GAAO,CACtBJ,EAAM,OAAOI,CAAE,CAAA,CAChB,EAEM,GAAGT,EAAQ,IAAIK,EAAM,SAAU,CAAA,EAAA,CACvC,EAEK,CAAE,KAAAK,EAAM,WAAYC,GAAYC,EAAWT,EAAc,CAAE,QAAS,EAAM,CAAA,EAAE,KAEhF,EACIU,EAAaT,EAAS,IAAM,OAChC,OAAOU,EAAAJ,EAAK,QAAL,YAAAI,EAAY,QAAA,CACpB,EACKC,EAAab,EAAI,EAAI"}