import{l as S,_ as G,a as J,c as N,b as M,d as O,e as B,f as Q,k as W,g as Y,h as Z,i as ee,j as te}from"./PaginationPrev.vue_vue_type_script_setup_true_lang-C-3SMG1q.js";import{_ as se}from"./TableCaption.vue_vue_type_script_setup_true_lang-Dm5TvMZr.js";import{d as T,A,p as v,o as l,e,w as s,b as t,y as E,f as i,D as y,t as w,g as d,C as b,c as m,q as C,F as R,n as F,v as L,E as ae,G as ne,L as le,r as oe,H as re}from"./index-C0rbQkID.js";import{_ as ue}from"./ListOfAvatars.vue_vue_type_script_setup_true_lang-Ch-42t7r.js";import{_ as H,a as q,b as P,c as V,d as K,e as U,g as X,f as z}from"./AlertDialogTrigger.vue_vue_type_script_setup_true_lang-CurKYkKi.js";import{_ as ie,a as ce,d as de,b as _e,c as me}from"./DialogContent.vue_vue_type_script_setup_true_lang-BIpJQgya.js";import{_ as fe}from"./AvatarFallback.vue_vue_type_script_setup_true_lang-C5yr75CT.js";import"./FemaleIcon-giXpYLUC.js";const pe=T({__name:"ApproveRoom",props:{room:{}},emits:["update"],setup(k,{emit:f}){const $=k,{patch:x}=A(`/rooms/${$.room._id}/approve`,{immediate:!1}),g=f,u=async()=>{const{data:n,execute:a}=x().json();await a(),n.value.status&&(g("update"),console.log("Aint nothing but a heartache"))};return(n,a)=>(l(),v(e(H),null,{default:s(()=>[t(e(q),null,{default:s(()=>[E(n.$slots,"default")]),_:3}),t(e(P),null,{default:s(()=>[t(e(V),null,{default:s(()=>[t(e(K),null,{default:s(()=>a[0]||(a[0]=[i(" Xác nhận yêu cầu Matching ")])),_:1}),t(e(U),null,{default:s(()=>[i(y(n.room.name),1)]),_:1})]),_:1}),t(e(X),{onClick:u},{default:s(()=>a[1]||(a[1]=[i("Tiếp tục")])),_:1}),t(e(z),null,{default:s(()=>a[2]||(a[2]=[i("Hủy")])),_:1})]),_:1})]),_:3}))}}),ve=T({__name:"RejectRoom",props:{room:{}},emits:["update"],setup(k,{emit:f}){const $=k,{patch:x}=A(`/rooms/${$.room._id}/reject`,{immediate:!1}),g=f,u=async()=>{const{data:n,execute:a}=x().json();await a(),n.value.status&&g("update")};return(n,a)=>(l(),v(e(H),null,{default:s(()=>[t(e(q),null,{default:s(()=>[E(n.$slots,"default")]),_:3}),t(e(P),null,{default:s(()=>[t(e(V),null,{default:s(()=>[t(e(K),null,{default:s(()=>a[0]||(a[0]=[i(" Từ chối yêu cầu Matching ")])),_:1}),t(e(U),null,{default:s(()=>[i(y(n.room.name),1)]),_:1})]),_:1}),t(e(X),{onClick:u},{default:s(()=>a[1]||(a[1]=[i("Tiếp tục")])),_:1}),t(e(z),null,{default:s(()=>a[2]||(a[2]=[i("Hủy")])),_:1})]),_:1})]),_:3}))}}),ge={class:"h-[400px] overflow-auto px-2 relative inset-shadow"},he={key:0},$e={class:"shrink-0 h-10 w-10"},xe={class:"grow bg-muted p-1 rounded"},ye={key:1,class:"h-full flex items-center justify-center"},ke={key:2,class:"h-full flex items-center justify-center text-xl font-semibold"},be=T({__name:"RoomMessageBox",props:{room:{}},setup(k){const f=k,$=w(()=>`messages/${f.room._id}/conversation`),{data:x,execute:g,isFetching:u}=A($,{immediate:!1}).json(),n=w(()=>{var r;return(r=x.value)==null?void 0:r.metaData}),a=w(()=>{const r=new Map;return f.room.memberDetails.forEach(_=>{r.set(_._id,_)}),r}),p=(r,_)=>n.value&&(r===0||a.value.get(n.value.results[r-1].sender)!==a.value.get(_.sender)),j=w(()=>{const r=a.value.entries().next().value;return r?r[1]._id:""});return(r,_)=>{const I=b("Icon");return l(),v(e(ie),null,{default:s(()=>[t(e(ce),null,{default:s(()=>[d("button",{onClick:_[0]||(_[0]=c=>e(g)())},[t(I,{name:"MessageSquareText"})])]),_:1}),t(e(de),null,{default:s(()=>{var c;return[t(e(_e),null,{default:s(()=>[t(e(me))]),_:1}),d("div",ge,[n.value?(l(),m("div",he,[(l(!0),m(R,null,F((c=n.value)==null?void 0:c.results,(o,h)=>(l(),m("div",{key:`${h}${o.content}`,class:L({"pt-4":p(h,o)})},[d("div",{class:L(["flex gap-2 pt-1",{"flex-row-reverse text-right":j.value===o.sender}])},[d("div",$e,[o.sender&&a.value.get(o.sender)&&p(h,o)?(l(),v(e(ae),{key:0,class:"self-start"},{default:s(()=>{var D;return[t(e(ne),{src:((D=a.value.get(o.sender))==null?void 0:D.avatarPath)??""},null,8,["src"]),t(e(fe))]}),_:2},1024)):C("",!0)]),d("div",xe,y(o.content),1),_[1]||(_[1]=d("div",{class:"shrink-0 h-10 w-10"},null,-1))],2)],2))),128))])):e(u)&&!n.value?(l(),m("div",ye,[t(S,{class:"w-8",icon:"spinning-circles"})])):n.value?C("",!0):(l(),m("div",ke," Không có dữ liệu tin nhắn phòng chat "))])]}),_:1})]),_:1})}}}),we=le(be,[["__scopeId","data-v-e0c319ea"]]),Ce={class:"mt-4"},je={class:"border rounded"},De={key:0,class:"flex items-center justify-center min-h-[10rem]"},Re={key:1,class:"flex items-center justify-center text-xl font-semibold min-h-[10rem]"},Te={class:"font-semibold max-w-[15rem] text-ellipsis overflow-hidden"},Ae={class:"flex gap-2 items-center"},Ie={class:"flex gap-2"},Me="/rooms",Pe=T({__name:"RoomList",setup(k){const f=oe({page:1,limit:10,userId:""}),$=w(()=>{const n=new URLSearchParams(f.value),a=[];return n.forEach((p,j)=>{(p===void 0||p==="undefined"||p==="")&&a.push(j)}),a.forEach(p=>{n.delete(p)}),`${Me}?${n.toString()}`}),{data:x,isFetching:g}=A($,{refetch:!0}).json(),u=w(()=>{var n;return(n=x.value)==null?void 0:n.metaData});return(n,a)=>{const p=b("CardTitle"),j=b("CardHeader"),r=b("Icon"),_=b("CardContent"),I=b("Card");return l(),v(I,{class:""},{default:s(()=>[t(j,null,{default:s(()=>[t(p,null,{default:s(()=>a[1]||(a[1]=[i(" Các phòng chat ")])),_:1})]),_:1}),t(_,null,{default:s(()=>[d("div",Ce,[d("div",je,[t(e(G),{class:"",loading:e(g)},{default:s(()=>[t(e(se),null,{default:s(()=>{var c;return[e(g)&&!u.value?(l(),m("div",De,[t(S,{class:"inline-block w-[2rem]",icon:"spinning-circles"})])):u.value&&((c=u.value)==null?void 0:c.results.length)<=0?(l(),m("div",Re," Không có dữ liệu phòng chat ")):C("",!0),a[2]||(a[2]=d("div",null,"Đây là các phòng chat trong hệ thống",-1))]}),_:1}),t(e(J),null,{default:s(()=>[t(e(N),null,{default:s(()=>[t(e(M),null,{default:s(()=>a[3]||(a[3]=[i(" Tên phòng ")])),_:1}),t(e(M),null,{default:s(()=>a[4]||(a[4]=[i(" Trạng thái xác nhận ")])),_:1}),t(e(M),null,{default:s(()=>a[5]||(a[5]=[i(" Ngày tạo ")])),_:1})]),_:1})]),_:1}),u.value?(l(),v(e(O),{key:0},{default:s(()=>{var c;return[(l(!0),m(R,null,F((c=u.value)==null?void 0:c.results,o=>(l(),v(e(N),{key:o._id,class:"odd:bg-(--color-background-mute)"},{default:s(()=>[t(e(B),null,{default:s(()=>[d("div",Te,y(o.name),1),d("div",Ae,[t(ue,{list:o.memberDetails},null,8,["list"]),t(we,{room:o},null,8,["room"])])]),_:2},1024),t(e(B),null,{default:s(()=>[d("div",Ie,[i(y(o.isApproved?"Đã xác nhận":"Chưa xác nhận")+" ",1),o.isApproved?C("",!0):(l(),m(R,{key:0},[t(pe,{room:o,class:"text-primary"},{default:s(()=>[t(r,{name:"Check"})]),_:2},1032,["room"]),t(ve,{room:o},{default:s(()=>[t(r,{class:"text-destructive",name:"X"})]),_:2},1032,["room"])],64))])]),_:2},1024),t(e(B),null,{default:s(()=>[i(y(e(re).format(new Date(o.createdAt))),1)]),_:2},1024)]),_:2},1024))),128))]}),_:1})):C("",!0)]),_:1},8,["loading"])]),u.value?(l(),v(e(Q),{key:0,class:"mt-4","items-per-page":u.value.limit,total:u.value.totalResults,"show-edges":"",page:f.value.page,"onUpdate:page":a[0]||(a[0]=c=>f.value.page=c),disabled:e(g)},{default:s(({page:c})=>[t(e(W),{class:"flex items-center gap-1"},{default:s(({items:o})=>[t(e(Y),{class:"w-6 h-6"}),(l(!0),m(R,null,F(o,(h,D)=>(l(),m(R,null,[h.type==="page"?(l(),v(e(Z),{key:D,value:h.value,"as-child":""},{default:s(()=>[d("button",{class:L(["w-6 h-6 p-0 hover:bg-primary/50 cursor-pointer rounded",{"bg-primary text-primary-foreground":h.value===c}])},y(h.value),3)]),_:2},1032,["value"])):(l(),v(e(ee),{key:h.type,index:D},null,8,["index"]))],64))),256)),t(e(te),{class:"w-6 h-6"})]),_:2},1024)]),_:1},8,["items-per-page","total","page","disabled"])):C("",!0)])]),_:1})]),_:1})}}});export{Pe as default};
//# sourceMappingURL=RoomList-C34WNjz7.js.map
